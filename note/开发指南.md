# 开发指南

## 热更新开发模式

本博客项目已集成热更新功能，让开发更加高效。

### 启动热更新服务器

```bash
# 安装依赖（首次运行）
npm install

# 启动热更新开发服务器
npm run dev
```

### 热更新功能

1. **自动刷新**：修改以下文件会自动刷新浏览器
   - Markdown 文章文件 (`source/_posts/*.md`)
   - 页面模板文件 (`source/_data/*.njk`)
   - 主题文件 (`themes/**/*`)

2. **同步交互**：多个浏览器或设备之间的操作会实时同步
   - 点击事件
   - 页面导航
   - 表单操作
   - 滚动位置

3. **控制面板**：访问 http://localhost:4001 查看浏览器同步控制面板

### 开发工作流程

1. **启动开发服务器**
   ```bash
   npm run dev
   ```

2. **创建新文章**
   ```bash
   hexo new '文章标题'
   ```

3. **编辑文章**
   ```bash
   # 编辑文章内容
   vim source/_posts/文章标题.md
   ```
   保存后会自动刷新浏览器

4. **修改模板或样式**
   ```bash
   # 修改自定义头部模板
   vim source/_data/head.njk
   
   # 修改主题样式
   # 注意：Next主题文件在node_modules/hexo-theme-next中
   # 如需修改，建议复制到themes/next目录下
   ```

5. **测试国际化功能**
   - 在浏览器中打开 http://localhost:4000
   - 点击右上角的语言切换器测试中英文翻译
   - 语言偏好会保存在Cookie中

6. **部署到生产环境**
   ```bash
   # 清理缓存
   npm run clean
   
   # 生成静态文件
   npm run build
   
   # 部署到GitHub Pages
   npm run deploy
   ```

### 注意事项

1. **修改主题文件**：如果需要修改Next主题，建议先复制主题文件到 `themes/next` 目录下，而不是直接修改 `node_modules` 中的文件

2. **翻译功能**：国际化功能依赖于Google Translate，需要联网环境才能正常工作

3. **浏览器兼容性**：热更新功能支持现代浏览器，如果使用旧版浏览器可能无法正常工作

4. **端口冲突**：默认使用4000端口作为主服务器，4001端口作为浏览器同步控制面板，确保这些端口未被占用

### 常见问题

1. **热更新不工作**：
   - 检查是否运行了 `npm run dev` 而不是 `npm run server`
   - 确认修改的文件类型在监控列表中

2. **浏览器同步控制面板无法访问**：
   - 确认开发服务器已启动
   - 检查4001端口是否被占用

3. **翻译功能异常**：
   - 确认网络连接正常
   - 检查是否有浏览器插件阻止Google Translate脚本加载